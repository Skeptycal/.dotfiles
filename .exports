#!/usr/bin/env bash
# *############################################################################

umask 022

function set_exports() {

    LANG='en_US.UTF-8'
    LC_ALL='en_US.UTF-8'
    CGO_ENABLED=1
    AZURE_WORKING_DIR="${HOME}/myagent"
    source_file "${dotfiles_path}/.homebrew_github_private.sh"
    source_file "${dotfiles_path}/.travis_token_private.sh"
    SH_KEY_PATH="${HOME}/.ssh/rsa_id"
    LOCAL_IP=$(ipconfig getifaddr en0)

    # System
    LDFLAGS="-L/usr/local/opt/zlib/lib"
    CPPFLAGS="-I/usr/local/opt/zlib/include"
    PKG_CONFIG_PATH="/usr/local/opt/zlib/lib/pkgconfig"
    HISTSIZE='32768'
    HISTFILESIZE="${HISTSIZE}"
    HISTCONTROL='ignoreboth'

    # Python
    PYTHONIOENCODING='UTF-8'
    # python sucks ... virtual environments suck ...
    # someone should find a better way to do this ... it's so stupid
    WORKON_HOME="${HOME}/.virtualenvs"
    PROJECT_HOME="${HOME}/Documents/coding/"
    source /usr/local/bin/virtualenvwrapper.sh

    # Java
    JAVA_HOME=$(/usr/libexec/java_home)
    M2_HOME="/usr/share/apache-maven-3.6.0"

    # Node
    NODE_REPL_HISTORY="${HOME}/.node_history"
    NODE_REPL_HISTORY_SIZE='32768'
    NODE_REPL_MODE='sloppy'

    # Perl
    PERL_MM_OPT="INSTALL_BASE=${HOME}/perl5"
    eval "$(perl -I"${HOME}/perl5/lib/perl5" -Mlocal::lib="${HOME}/perl5")"

    # Heroku autocomplete setup
    HEROKU_AC_BASH_SETUP_PATH="/Volumes/Data/skeptycal/Library/Caches/heroku/autocomplete/bash_setup" && test -f "$HEROKU_AC_BASH_SETUP_PATH" && source "$HEROKU_AC_BASH_SETUP_PATH"

    ############################################################################
    # Enable some Bash 4 features when possible:
    # Case-insensitive globbing (used in pathname expansion) : shopt -s nocaseglob;
    # Append to the Bash history file vs. overwriting it : shopt -s histappend;
    # Autocorrect typos in path names when using `cd` : shopt -s cdspell;
    # Autocd, e.g. `**/qux` will enter `./foo/bar/baz/qux`
    # Recursive globbing, e.g. `echo **/*.txt`
    for option in nocaseglob histappend cdspell autocd globstar; do
        shopt -s "$option" &>/dev/null
    done
}

function run_debug_exports() {
    # list current versions of common utilities
    ce "Script source:$MAIN $BASH_SOURCE$RESET"
    green "\$LANG is set to $LANG."
    green "\$LOCAL_IP is set to and exported as $LOCAL_IP."
}
function main_exports() {
    set_exports
    [[ $DEBUG == '1' ]] && run_debug_exports
}

main_exports "$@"

# 'todo' app
# alias t='./todo.sh -d /path/to/your/todo.cfg'
# 'TODOTXT_DEFAULT_ACTION=ls
# export TODOTXT_DEFAULT_ACTION
# 'TODOTXT_SORT_COMMAND='env LC_COLLATE=C sort -k 2,2 -k 1,1n'
# export TODOTXT_SORT_COMMAND
